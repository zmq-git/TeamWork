(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4577152a"],{"351c":function(t,e,a){},e7e9:function(t,e,a){"use strict";var r=a("351c"),o=a.n(r);o.a},fa3e:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{xl:24,lg:24,md:24,sm:24,xs:24}},[1==t.state?a("a-card",{staticClass:"project-list",staticStyle:{"margin-bottom":"15px"},attrs:{bordered:!1,loading:t.loading,title:"进行中的项目","body-style":{padding:0}}},[a("div",{attrs:{slot:"extra"},slot:"extra"},[a("a-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"dashed"},on:{click:function(e){return t.getProjects(2)}}},[a("a-icon",{attrs:{type:"project"}}),t._v("全部项目")],1),a("router-link",{attrs:{to:{path:"/tm/projectList",query:{state:"1"}}}},[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[a("span",[t._v("列表视图")])]),a("a-button",{staticClass:"new-btn",attrs:{type:"dashed",icon:"setting"}})],2)],1)],1)]):a("a-card",{staticClass:"project-list",staticStyle:{"margin-bottom":"15px"},attrs:{bordered:!1,loading:t.loading,title:"全部项目","body-style":{padding:0}}},[a("div",{attrs:{slot:"extra"},slot:"extra"},[a("a-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"dashed"},on:{click:function(e){return t.getProjects(1)}}},[a("a-icon",{attrs:{type:"project"}}),t._v("进行中的项目")],1),a("router-link",{attrs:{to:{path:"/tm/projectList",query:{state:"2"}}}},[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[a("span",[t._v("列表视图")])]),a("a-button",{staticClass:"new-btn",attrs:{type:"dashed",icon:"setting"}})],2)],1)],1)])],1)],1),a("div",{staticClass:"ant-pro-pages-list-projects-cardList"},[a("a-list",{attrs:{loading:t.loading,"data-source":t.projects,grid:{gutter:24,xl:4,lg:3,md:3,sm:2,xs:1}},scopedSlots:t._u([{key:"renderItem",fn:function(e,r){return a("a-list-item",{},[null===e?[a("a-card",{attrs:{id:"card",hoverable:""},on:{click:function(e){return t.$refs.projectType.add()}}},[a("a-icon",{attrs:{type:"plus"}}),t._v("\n                            创建新项目\n                    ")],1)]:[a("a-card",{staticClass:"ant-pro-pages-list-projects-card",attrs:{hoverable:""}},[a("router-link",{attrs:{to:{path:"/tm/tab",query:{activekey:"1",id:e.projectId,name:e.projectName}}}},[a("a-card-meta",[a("div",{staticStyle:{"margin-bottom":"3px"},attrs:{slot:"title"},slot:"title"},[a("a-tooltip",{attrs:{placement:"topRight"}},[a("template",{slot:"title"},[a("span",[t._v(t._s(e.projectName))])]),t._v("\n                                "+t._s(e.projectName)+"\n                             ")],2)],1),a("div",{attrs:{slot:"avatar"},slot:"avatar"},[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[a("span",[t._v(t._s(e.projectTypeName))])]),a("a-avatar",{staticClass:"card-avatar",attrs:{src:e.projectPicture,size:"large"}})],2)],1),a("div",{staticClass:"meta-content",attrs:{slot:"description"},slot:"description"},[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[a("span",[t._v(t._s(e.projectDetail))])]),a("span",[a("ellipsis",{attrs:{length:17}},[t._v(t._s(e.projectDetail))])],1)],2)],1)])],1),a("template",{staticClass:"ant-card-actions",slot:"actions"},[a("a-tooltip",{attrs:{title:"项目成员"},on:{click:function(a){return t.$refs.addUser.add(e.projectId)}}},[a("a-icon",{attrs:{type:"team"}})],1),a("a-popconfirm",{attrs:{title:"确定要删除吗？",okText:"Yes",cancelText:"No"},on:{confirm:function(a){return t.confirm(e.projectId)}}},[a("a-tooltip",{attrs:{title:"删除"}},[a("a-icon",{attrs:{type:"delete"}})],1)],1),a("a-tooltip",{attrs:{title:"编辑"},on:{click:function(a){return t.modify(e.projectName)}}},[a("a-icon",{attrs:{type:"edit"}})],1)],1)],2)]],2)}}])})],1),a("modifyProject",{ref:"modifyPro",on:{childFn:t.parentFn}}),a("addUser",{ref:"addUser"}),a("projectType",{ref:"projectType",on:{"submit-add":t.appendToList}})],1)},o=[],s=a("47d5"),i=(a("ca00"),a("08c1"),a("24d2")),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{width:640,visible:t.visible,title:"修改项目"},on:{ok:t.handleSubmit,cancel:t.cancel}},[a("a-form",{attrs:{form:t.form},on:{submit:t.handleSubmit}},[a("a-form-item",{attrs:{label:"项目名称",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["projectName",{rules:[{required:!0,message:"请输入项目名称"}]}],expression:"['projectName', {rules:[{required: true, message: '请输入项目名称'}]}]"}],ref:"myInput",attrs:{disabled:"disabled"}})],1),a("a-form-item",{attrs:{label:"项目类型",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["projectType"],expression:"['projectType']"}],attrs:{disabled:"disabled"}})],1),a("a-form-item",{attrs:{label:"项目周期",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["time",{rules:[{required:!0,message:"请设置项目周期"}]}],expression:"['time', {rules:[{required: true, message: '请设置项目周期'}]}]"}],attrs:{format:"YYYY-MM-DD"}})],1),a("a-form-item",{attrs:{label:"项目描述",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["projectDetail"],expression:"['projectDetail']"}]})],1)],1)],1)},n=[],c=a("6bf2"),p=a.n(c),d=a("92b4"),m={name:"ModifyProject",components:{ProjectList:d["default"]},data:function(){return{labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},list:[],current:0,pageSize:0,visible:!1,disabled:!0,form:this.$form.createForm(this),date:[],dateFormat:"YYYY-MM-DD "}},methods:{moment:p.a,add:function(){this.visible=!0},edit:function(t){var e=this.form.setFieldsValue;this.visible=!0,this.$nextTick((function(){e({taskName:"test"})}))},handleSubmit:function(){var t=this;this.date=[],this.form.validateFields((function(e,a){if(!e){if(t.list.startDate==a.time[0]&&t.list.endDate==a.time[1]&&t.list.projectDetail==a.projectDetail)return void t.$message.info("提示：你没有做修改");var r={projectId:t.list.projectId,projectDetail:a.projectDetail,startDate:a.time[0],endDate:a.time[1]};console.log("projectInfo:",r),Object(i["i"])(r).then((function(e){e?(t.$message.success("项目修改成功"),t.form.resetFields(),t.visible=!1,t.$emit("childFn")):(t.$message.error("项目修改失败,请重新修改"),t.form.resetFields(),t.visible=!1)}))}}))},modifyPro:function(t){this.list=t,this.form.getFieldDecorator("projectName",{initialValue:t.projectName}),this.form.getFieldDecorator("projectType",{initialValue:t.projectTypeName}),this.form.getFieldDecorator("projectDetail",{initialValue:t.projectDetail}),this.date=[],this.date.push(p()(t.startDate,"YYYY-MM-DD HH:mm:ss")),this.date.push(p()(t.endDate,"YYYY-MM-DD HH:mm:ss")),this.form.getFieldDecorator("time",{initialValue:this.date})},cancel:function(){this.visible=!1,this.form.resetFields()}}},u=m,f=a("4e82"),j=Object(f["a"])(u,l,n,!1,null,null,null),h=j.exports,g=a("b2ae"),v=a("2af9"),b={name:"ProjectCard",components:{modifyProject:h,addUser:g["a"],Ellipsis:v["g"],projectType:s["a"]},data:function(){return{state:1,projects:[],loading:!0,avatar:"https://gw.alipayobjects.com/zos/rmsportal/uMfMFlvUuceEyPpotzlq.png"}},mounted:function(){this.getProjects(1)},methods:{getProjects:function(t){var e=this;this.state=t,this.loading=!0,this.projects=[],this.projects.push(null),Object(i["e"])({projectPeriod:this.state}).then((function(t){var a={current:1,pageSize:t,projectPeriod:e.state};Object(i["d"])(a).then((function(t){console.log(t);for(var a=0;a<t.length;a++)e.projects.push(t[a])}))})),setTimeout((function(){e.loading=!1}),2e3)},appendToList:function(t){this.projects=[],this.getProjects(this.state)},modify:function(t){var e=this,a={projectName:t};Object(i["k"])(a).then((function(t){console.log("result:",t),console.log(e.$refs),t&&(e.$refs.modifyPro.add(),e.$refs.modifyPro.modifyPro(t))}))},parentFn:function(){this.projects=[],this.getProjects(this.state)},confirm:function(t){this.del(t)},del:function(t){var e=this;console.log("33333333333333333333"),console.log(t);var a={projectId:t};Object(i["c"])(a).then((function(t){t?(e.$message.success("删除成功"),e.loading=!0,e.projects=[],e.getProjects(e.state)):e.$message.error("删除失败！")}))}}},y=b,C=(a("e7e9"),Object(f["a"])(y,r,o,!1,null,"423c47d8",null));e["default"]=C.exports}}]);